<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contact - Melissa DiFonzo Psychotherapy</title>
  <link rel="icon" type="image/x-icon" href="/resources/favicon/android-chrome-512x512.png">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/js/all.min.js"
    integrity="sha512-6PM0qYu5KExuNcKt5bURAoT6KCThUmHRewN3zUFNaoI6Di7XJPTMoT6K0nsagZKk2OB4L7E3q1uQKHNHd4stIQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.2/font/bootstrap-icons.css">
  <link rel="stylesheet" href="/custom.css" />
  <link rel="stylesheet" href="/normalize.css" />
  
  <!-- EmailJS SDK -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  
  <!-- Google reCAPTCHA v2 Invisible -->
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
  
  <script src="/components/banner.js"></script>
  <script src="/components/nav.js"></script>
  <script src="/components/footer.js"></script>
</head>

<body style="font-family: 'Avenir LT Std', sans-serif;background-color: white;">

  <div id="banner-placeholder"></div>

  <!-------------navbar--------------->
  <div id="nav-placeholder" data-active="contact" data-logo="blog"></div>

  <!-------------contact form section--------------->
  <div class="container" style="max-width: 800px; margin-top: 25px; margin-bottom: 40px;">
    
    <!-- Header -->
    <div class="text-center mb-3">
      <h1 style="color: #361b4e; font-size: 2.2em; font-weight: 300; line-height: 1.3; margin-bottom: 15px;">
        New client? <em style="font-style: italic; color: #a352ea;">Past client</em>, someone else?<br>
        <span style="color: #DC3494;">Let's chat.</span>
      </h1>
    </div>

    <!-- Intake Form -->
    <div class="card shadow-sm" style="border: none; border-radius: 15px; padding: 30px;">
      
      <form id="contactForm" action="#" method="POST">
        
        <!-- First Name -->
        <div class="mb-3">
          <label for="firstName" class="form-label" style="color: #361b4e; font-weight: 500;">
            What's your first name? <span style="color: #DC3494;">*</span>
          </label>
          <input type="text" class="form-control" id="firstName" name="firstName" required
            style="border: 2px solid #a352ea; border-radius: 8px; padding: 10px; font-size: 16px;">
        </div>

        <!-- Last Name -->
        <div class="mb-3">
          <label for="lastName" class="form-label" style="color: #361b4e; font-weight: 500;">
            What's your last name? <span style="color: #DC3494;">*</span>
          </label>
          <input type="text" class="form-control" id="lastName" name="lastName" required
            style="border: 2px solid #a352ea; border-radius: 8px; padding: 10px; font-size: 16px;">
        </div>

        <!-- Email Address -->
        <div class="mb-3">
          <label for="email" class="form-label" style="color: #361b4e; font-weight: 500;">
            What's your email address? <span style="color: #DC3494;">*</span>
          </label>
          <input type="email" class="form-control" id="email" name="email" required
            style="border: 2px solid #a352ea; border-radius: 8px; padding: 10px; font-size: 16px;">
        </div>

        <!-- Phone Number -->
        <div class="mb-3">
          <label for="phone" class="form-label" style="color: #361b4e; font-weight: 500;">
            What's your phone number?
          </label>
          <input type="tel" class="form-control" id="phone" name="phone"
            style="border: 2px solid #a352ea; border-radius: 8px; padding: 10px; font-size: 16px;">
        </div>

        <!-- Inquiry -->
        <div class="mb-3">
          <label for="inquiry" class="form-label" style="color: #361b4e; font-weight: 500;">
            What are you inquiring about? <span style="color: #DC3494;">*</span>
          </label>
          <textarea class="form-control" id="inquiry" name="inquiry" rows="5" required
            style="border: 2px solid #a352ea; border-radius: 8px; padding: 10px; font-size: 16px; resize: vertical;"></textarea>
        </div>

        <!-- reCAPTCHA invisible badge container -->
        <div id="recaptcha-container"></div>

        <!-- Submit Button -->
        <div class="text-center mt-3">
          <button type="submit" class="btn btn-lg" 
            style="background-color: #DC3494; color: white; border: none; border-radius: 25px; 
            padding: 12px 45px; font-size: 18px; font-weight: 500; transition: all 0.3s ease;"
            onmouseover="this.style.backgroundColor='#a352ea'"
            onmouseout="this.style.backgroundColor='#DC3494'">
            Submit
          </button>
        </div>
      </form>
    </div>

  </div>

  <!-------------footer--------------->
  <div id="footer-placeholder" data-bgcolor="white"></div>

  <!-- EmailJS Configuration and Form Handler -->
  <script>
    // ========================================
    // SETUP - FILL IN YOUR CREDENTIALS
    // ========================================
    // EMAILJS SETUP:
    // 1. Go to https://www.emailjs.com/ and create a free account
    // 2. Add an email service (Gmail, Outlook, etc.)
    // 3. Create an email template with these variables: {{from_name}}, {{from_email}}, {{phone}}, {{message}}
    // 4. Get your Public Key from Account > API Keys
    
    // RECAPTCHA SETUP:
    // 1. Your Site Key is already in the <head> section (line 29)
    // 2. In EmailJS dashboard, go to Security > Enable reCAPTCHA V2 and add your Secret Key
    
    const EMAILJS_PUBLIC_KEY = 'WsURv7JzOcAQ2clSu';  // EmailJS public key
    const EMAILJS_SERVICE_ID = 'service_cv2frwi';  // Service ID
    const EMAILJS_TEMPLATE_ID = 'template_hr9cbb8'; // Template ID
    const RECAPTCHA_SITE_KEY = '6LcgWmwsAAAAAPw_eqRwksdpBs7HdZ4X_ORJK65O';    // reCAPTCHA v2 site key
    
    // Initialize EmailJS
    (function() {
      emailjs.init(EMAILJS_PUBLIC_KEY);
    })();

    // reCAPTCHA callback function
    window.onSubmitRecaptcha = function(token) {
      const form = document.getElementById('contactForm');
      const submitBtn = form.querySelector('button[type="submit"]');
      
      submitBtn.textContent = 'Sending...';
      
      // Prepare template parameters
      const templateParams = {
        from_name: document.getElementById('firstName').value + ' ' + document.getElementById('lastName').value,
        from_email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        message: document.getElementById('inquiry').value,
        to_email: 'melissa@difonzotherapy.com',
        'g-recaptcha-response': token // reCAPTCHA token for EmailJS verification
      };
      
      // Send email using EmailJS
      emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, templateParams)
        .then(function(response) {
          console.log('SUCCESS!', response.status, response.text);
          
          // Show success message
          alert('Thank you for your message! We will get back to you as soon as possible.');
          
          // Reset form and reCAPTCHA
          form.reset();
          grecaptcha.reset();
          
          // Re-enable submit button
          submitBtn.disabled = false;
          submitBtn.textContent = 'Submit';
          submitBtn.style.backgroundColor = '#DC3494';
        }, function(error) {
          console.log('FAILED...', error);
          
          // Show error message
          alert('Oops! Something went wrong. Please try again or email us directly at melissa@difonzotherapy.com');
          
          // Reset reCAPTCHA and re-enable button
          grecaptcha.reset();
          submitBtn.disabled = false;
          submitBtn.textContent = 'Submit';
          submitBtn.style.backgroundColor = '#DC3494';
        });
    };

    // Form submission handler
    document.getElementById('contactForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Disable submit button to prevent double submission
      const submitBtn = e.target.querySelector('button[type="submit"]');
      submitBtn.disabled = true;
      submitBtn.textContent = 'Verifying...';
      submitBtn.style.backgroundColor = '#a352ea';
      
      // Execute invisible reCAPTCHA
      grecaptcha.execute();
    });
    
    // Render invisible reCAPTCHA when page loads
    window.onload = function() {
      grecaptcha.render('recaptcha-container', {
        'sitekey': RECAPTCHA_SITE_KEY,
        'callback': onSubmitRecaptcha,
        'size': 'invisible'
      });
    };
  </script>

</body>

</html>
